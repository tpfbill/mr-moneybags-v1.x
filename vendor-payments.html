<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NACHA Vendor Payments - Nonprofit Fund Accounting</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="src/css/vendor-payments.css" rel="stylesheet">
    <link rel="stylesheet" href="src/css/styles.css?v=20251008f">
    <script>
    (function(){
      const devPorts = ['8080','8081'];
      let API_BASE;
      if (devPorts.includes(window.location.port)) {
        API_BASE = `${window.location.protocol}//${window.location.hostname}:3000`;
      } else {
        API_BASE = window.location.origin;
      }
      window.API_BASE = API_BASE;
    })();
    </script>
</head>
<body>
    <div class="header">
        <div class="header-container">
            <h1>Mr. MoneyBags v1.x</h1>
            <div class="header-right-controls">
                <div class="db-status-container">
                    <span id="db-status-indicator" class="offline">DB Offline</span>
                </div>
                <div class="entity-selector-container">
                    <label for="entity-selector" style="font-weight: 500; color: white;">Entity:</label>
                    <select id="entity-selector">
                        <option value="">Loading Entities...</option>
                    </select>
                </div>
                <div class="user-info"><span>User</span><button class="logout-button" id="btnLogout">Logout</button></div>
            </div>
        </div>
    </div>
        <!-- (Removed misplaced Documentation section – will be added inside main-content) -->

    <div class="main-nav" id="mainNavContainer"> 
        <div class="nav-container">
            <div class="nav-item" data-page="dashboard">Dashboard</div>
            <div class="nav-item" data-page="chart-of-accounts">Chart of Accounts</div>
            <div class="nav-item" data-page="gl-codes">GL Codes</div>
            <div class="nav-item" data-page="funds">Funds</div>
            <div class="nav-item" data-page="journal-entries">Journal Entries</div>
            <!-- Vendor Payments navigation -->
            <div class="nav-item" onclick="window.location.href='/vendor-payments.html'">Vendor Payments</div>
            <!-- Bank Deposits navigation (consolidated) -->
            <div class="nav-item" onclick="window.location.href='/bank-deposits.html'">Bank Deposits</div>
            <!-- Check Printing navigation -->
            <div class="nav-item" onclick="window.location.href='check-printing.html'">Check Printing</div>
            <!-- Bank Reconciliation navigation -->
            <div class="nav-item" onclick="window.location.href='bank-reconciliation.html'">Bank Reconcilia&shy;tion</div>
            <!-- Inter-Entity Transfer wizard navigation -->
            <div class="nav-item" onclick="window.location.href='inter-entity-transfer.html'">Inter-Entity Transfer</div>
            <div class="nav-item" data-page="fund-reports">Fund Reports</div>
            <!-- Custom Reports Builder navigation -->
            <div class="nav-item" onclick="window.location.href='custom-reports.html'">Custom Reports</div>
            <!-- Natural Language Queries navigation -->
            <div class="nav-item" onclick="window.location.href='ask-questions.html'">Ask Questions</div>
            <!-- Documentation Library (single-page view) -->
            <div class="nav-item" data-page="documentation">Guides</div>
            <!-- Default Reports (separate from Fund Reports) -->
            <div class="nav-item" onclick="window.location.href='default-reports.html'">Default Reports</div>
            <div class="nav-item" data-page="settings">Settings</div>
        </div>
    </div>

    <div class="loading-overlay">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <div class="container-fluid mt-4">
        
        <div class="row">
            <div class="col-12 d-flex align-items-baseline gap-3">
                <h1>Vendor Payments</h1>
                <p class="lead mb-0">Manage vendors, payment batches, and generate NACHA files for ACH transfers.</p>
            </div>
        </div>

        <ul class="nav nav-tabs" id="paymentTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="batches-tab" data-bs-toggle="tab" data-bs-target="#batches" type="button" role="tab">Payment Batches</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="vendors-tab" data-bs-toggle="tab" data-bs-target="#vendors" type="button" role="tab">Vendors</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab">NACHA Settings</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="files-tab" data-bs-toggle="tab" data-bs-target="#files" type="button" role="tab">NACHA Files</button>
            </li>
        </ul>

        <div class="tab-content" id="paymentTabsContent">
            <!-- PAYMENT BATCHES TAB -->
            <div class="tab-pane fade show active" id="batches" role="tabpanel">

                <!-- ---------------- PAYMENTS CSV IMPORT (one-click) ---------------- -->
                <div class="card mb-3">
                    <div class="card-body d-flex flex-wrap align-items-center gap-2">
                        <input type="file"
                               id="paymentsCsvFile"
                               accept=".csv,text/csv"
                               class="form-control"
                               style="max-width: 400px;">

                        <button class="btn btn-outline-primary" id="importPaymentsBtn">
                            <i class="fas fa-file-import"></i> Import Payments CSV
                        </button>
                    </div>
                </div>

                <!-- ---------------- PAYMENT IMPORT LOG ---------------- -->
                <details class="card mb-3" open>
                    <summary class="card-header">Payment Import Log</summary>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm" id="paymentsImportLogTable">
                                <thead>
                                    <tr>
                                        <th style="width: 80px;">Row</th>
                                        <th style="width: 120px;">Level</th>
                                        <th>Message</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="3" class="text-center">No recent import log</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </details>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="input-group">
                            <input type="text" class="form-control" id="batchSearchInput" placeholder="Search batches...">
                            <button class="btn btn-outline-secondary" type="button" id="batchSearchBtn">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex justify-content-end">
                            <select class="form-select me-2" id="batchStatusFilter" style="width: auto;">
                                <option value="">All Statuses</option>
                                <option value="draft">Draft</option>
                                <option value="pending_approval">Pending Approval</option>
                                <option value="approved">Approved</option>
                                <option value="processed">Processed</option>
                            </select>
                            <button class="btn btn-outline-secondary" id="refreshBatchesBtn">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="batchesTable">
                        <thead>
                            <tr>
                                <th>Batch Number</th>
                                <th>Date Created</th>
                                <th>Bank</th>
                                <th>Number of Items</th>
                                <th>Total Amount</th>
                                <th>Created By</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="batchesTableBody">
                            <!-- Batch rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- VENDORS TAB -->
            <div class="tab-pane fade" id="vendors" role="tabpanel">
                <div class="section-header d-flex justify-content-between align-items-center">
                    <h2>Vendors <span id="vendorsCountBadge" class="badge bg-secondary ms-2">0</span></h2>
                    <button id="newVendorBtn" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createVendorModal">
                        <i class="fas fa-plus"></i> New Vendor
                    </button>
                </div>

                <!-- ---------------- CSV IMPORT CARD ---------------- -->
                <div class="card mb-3">
                    <div class="card-body d-flex flex-wrap align-items-center gap-2">
                        <input type="file"
                               id="vendorCsvFile"
                               accept=".csv,text/csv"
                               class="form-control"
                               style="max-width: 400px;">

                        <button class="btn btn-outline-primary" id="importVendorsBtn">
                            <i class="fas fa-file-import"></i> Import CSV
                        </button>

                        <!-- Export CSV button -->
                        <button class="btn btn-outline-success" id="exportVendorsBtn">
                            <i class="fas fa-file-export"></i> Export CSV
                        </button>

                        <!-- zID / Name search inputs -->
                        <input type="text"
                               id="vendorSearchZid"
                               placeholder="Search zID…"
                               class="form-control"
                               style="max-width: 180px;">

                        <input type="text"
                               id="vendorSearchName"
                               placeholder="Search name…"
                               class="form-control"
                               style="max-width: 240px;">

                        <!-- Clear search button -->
                        <button class="btn btn-outline-secondary" id="clearVendorSearchBtn">
                            <i class="fas fa-times"></i> Clear
                        </button>

                        <button class="btn btn-outline-secondary ms-auto" id="refreshVendorsBtn">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>

                        <small class="text-muted w-100 mt-2">
                            Expected CSV headers: zID, name, name_detail, email, street_1, street_2, city, state, zip,
                            country, tax_id, vendor_type, subject_to_1099, bank_account_type, bank_routing_number,
                            bank_account_number, last_used, status, account_type, payment_type
                        </small>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="vendorsTable">
                        <thead>
                            <tr>
                                <th class="sticky-col-1">zID</th>
                                <th class="sticky-col-2">Name</th>
                                <th>Name Detail</th>
                                <th>Account Type</th>
                                <th>Vendor Type</th>
                                <th>Tax ID</th>
                                <th>Email</th>
                                <th>Street 1</th>
                                <th>Street 2</th>
                                <th>City</th>
                                <th>State</th>
                                <th>Zip</th>
                                <th>Country</th>
                                <th>Subject to 1099</th>
                                <th>Payment Type</th>
                                <th>Bank Account Type</th>
                                <th>Bank Routing Number</th>
                                <th>Bank Account Number</th>
                                <th>Last Used</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="vendorsTableBody">
                            <!-- Vendor rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- NACHA SETTINGS TAB -->
            <div class="tab-pane fade" id="settings" role="tabpanel">
                <div class="section-header d-flex justify-content-between align-items-center">
                    <h2>NACHA Settings</h2>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createNachaSettingsModal">
                        <i class="fas fa-plus"></i> New NACHA Configuration
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="nachaSettingsTable">
                        <thead>
                            <tr>
                                <th>Company Name</th>
                                <th>Company ID</th>
                                <th>Originating DFI ID</th>
                                <th>Entry Description</th>
                                <th>Settlement Account</th>
                                <th>Production Mode</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="nachaSettingsTableBody">
                            <!-- NACHA settings rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- NACHA FILES TAB -->
            <div class="tab-pane fade" id="files" role="tabpanel">
                <div class="section-header d-flex justify-content-between align-items-center">
                    <h2>NACHA Files</h2>
                    <button class="btn btn-outline-secondary" id="refreshFilesBtn">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="nachaFilesTable">
                        <thead>
                            <tr>
                                <th>File Name</th>
                                <th>Batch Number</th>
                                <th>File Date</th>
                                <th>Total Amount</th>
                                <th>Items</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="nachaFilesTableBody">
                            <!-- NACHA files rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Batch Modal -->
    <div class="modal fade" id="createBatchModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Create Payment Batch</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="createBatchForm">
                        <div class="mb-3">
                            <label for="batchEntityId" class="form-label">Entity*</label>
                            <select class="form-select" id="batchEntityId" required>
                                <option value="">-- Select Entity --</option>
                                <!-- Entities will be populated dynamically -->
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label for="batchFundId" class="form-label">Fund</label>
                            <select class="form-select" id="batchFundId">
                                <option value="">-- Select Fund --</option>
                                <!-- Funds will be populated dynamically -->
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label for="nachaSettingsId" class="form-label">NACHA Settings*</label>
                            <select class="form-select" id="nachaSettingsId" required>
                                <option value="">-- Select NACHA Configuration --</option>
                                <!-- NACHA settings will be populated dynamically -->
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label for="batchDate" class="form-label">Batch Date*</label>
                            <input type="date" class="form-control" id="batchDate" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="effectiveDate" class="form-label">Effective Date*</label>
                            <input type="date" class="form-control" id="effectiveDate" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="batchDescription" class="form-label">Description*</label>
                            <input type="text" class="form-control" id="batchDescription" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveBatchBtn">Create Batch</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success/Error Toast -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
        <div id="toastNotification" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="me-auto" id="toastTitle">Notification</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toastMessage">
                Operation completed successfully.
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!-- CSV parser for client-side processing -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="src/js/app.js"></script>
    <script src="src/js/vendor-payments.js"></script>
    <script src="src/js/page-navigation.js"></script>

    <!-- ===================================================================== -->
    <!--  VENDOR CRUD MODALS                                                   -->
    <!-- ===================================================================== -->

    <!-- Create Vendor -->
    <div class="modal fade" id="createVendorModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">New Vendor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="createVendorForm">
                    <div class="modal-body">
                        <!-- zID (business identifier) -->
                        <div class="mb-3">
                            <label for="zid" class="form-label">zID*</label>
                            <input type="text" id="zid" class="form-control" required />
                        </div>

                        <div class="mb-3">
                            <label for="vendorName" class="form-label">Vendor Name*</label>
                            <input type="text" id="vendorName" class="form-control" required />
                        </div>
                        <!-- New core vendor fields -->
                        <div class="mb-3">
                            <label for="accountType" class="form-label">Account Type*</label>
                            <select id="accountType" class="form-select" required>
                                <option value="Individual">Individual</option>
                                <option value="Business">Business</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="paymentType" class="form-label">Payment Type*</label>
                            <select id="paymentType" class="form-select" required>
                                <option value="EFT">EFT</option>
                                <option value="Check">Check</option>
                                <option value="PayPal">PayPal</option>
                                <option value="Autodraft">Autodraft</option>
                                <option value="Cap One">Cap One</option>
                                <option value="Convera">Convera</option>
                            </select>
                        </div>
                        <!-- New extended vendor fields -->
                        <div class="mb-3">
                            <label for="nameDetail" class="form-label">Name Detail</label>
                            <input type="text" id="nameDetail" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="taxId" class="form-label">Tax ID</label>
                            <input type="text" id="taxId" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="vendorType" class="form-label">Vendor Type</label>
                            <select id="vendorType" class="form-select">
                                <option value="supplier">Supplier</option>
                                <option value="contractor">Contractor</option>
                                <option value="employee">Employee</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="street1" class="form-label">Street&nbsp;1</label>
                            <input type="text" id="street1" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="street2" class="form-label">Street&nbsp;2</label>
                            <input type="text" id="street2" class="form-control" />
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="city" class="form-label">City</label>
                                <input type="text" id="city" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="state" class="form-label">State</label>
                                <input type="text" id="state" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="zip" class="form-label">Zip</label>
                                <input type="text" id="zip" class="form-control" />
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="country" class="form-label">Country</label>
                            <input type="text" id="country" class="form-control" value="USA" />
                        </div>
                        <div class="mb-3">
                            <label for="subjectTo1099" class="form-label">Subject to 1099?</label>
                            <select id="subjectTo1099" class="form-select">
                                <option value="false">No</option>
                                <option value="true">Yes</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="bankAccountType" class="form-label">Bank Account Type</label>
                            <select id="bankAccountType" class="form-select">
                                <option value="Checking">Checking</option>
                                <option value="Savings">Savings</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="bankRoutingNumber" class="form-label">Bank Routing Number</label>
                            <input type="text" id="bankRoutingNumber" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="bankAccountNumber" class="form-label">Bank Account Number</label>
                            <input type="text" id="bankAccountNumber" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="contactName" class="form-label">Contact Name</label>
                            <input type="text" id="contactName" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="vendorEmail" class="form-label">Email</label>
                            <input type="email" id="vendorEmail" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="vendorStatus" class="form-label">Status</label>
                            <select id="vendorStatus" class="form-select">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="vendorNotes" class="form-label">Notes</label>
                            <textarea id="vendorNotes" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="saveVendorBtn">Save Vendor</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Vendor -->
    <div class="modal fade" id="editVendorModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Vendor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="editVendorForm">
                    <div class="modal-body">
                        <input type="hidden" id="editVendorId" />
                        <div class="mb-3">
                            <label for="editZid" class="form-label">zID*</label>
                            <input type="text" id="editZid" class="form-control" required />
                        </div>
                        <!-- Entity and Vendor Code fields removed per new requirements -->
                        <div class="mb-3">
                            <label for="editVendorName" class="form-label">Vendor Name*</label>
                            <input type="text" id="editVendorName" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label for="editNameDetail" class="form-label">Name Detail</label>
                            <input type="text" id="editNameDetail" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="editTaxId" class="form-label">Tax ID</label>
                            <input type="text" id="editTaxId" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="editVendorType" class="form-label">Vendor Type</label>
                            <select id="editVendorType" class="form-select">
                                <option value="supplier">Supplier</option>
                                <option value="contractor">Contractor</option>
                                <option value="employee">Employee</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <!-- New Account & Payment type fields -->
                        <div class="mb-3">
                            <label for="editAccountType" class="form-label">Account Type*</label>
                            <select id="editAccountType" class="form-select" required>
                                <option value="Individual">Individual</option>
                                <option value="Business">Business</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editPaymentType" class="form-label">Payment Type*</label>
                            <select id="editPaymentType" class="form-select" required>
                                <option value="EFT">EFT</option>
                                <option value="Check">Check</option>
                                <option value="PayPal">PayPal</option>
                                <option value="Autodraft">Autodraft</option>
                                <option value="Cap One">Cap One</option>
                                <option value="Convera">Convera</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editStreet1" class="form-label">Street&nbsp;1</label>
                            <input type="text" id="editStreet1" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="editStreet2" class="form-label">Street&nbsp;2</label>
                            <input type="text" id="editStreet2" class="form-control" />
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="editCity" class="form-label">City</label>
                                <input type="text" id="editCity" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="editState" class="form-label">State</label>
                                <input type="text" id="editState" class="form-control" />
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="editZip" class="form-label">Zip</label>
                                <input type="text" id="editZip" class="form-control" />
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editCountry" class="form-label">Country</label>
                            <input type="text" id="editCountry" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="editSubjectTo1099" class="form-label">Subject to 1099?</label>
                            <select id="editSubjectTo1099" class="form-select">
                                <option value="false">No</option>
                                <option value="true">Yes</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editBankAccountType" class="form-label">Bank Account Type</label>
                            <select id="editBankAccountType" class="form-select">
                                <option value="Checking">Checking</option>
                                <option value="Savings">Savings</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editBankRoutingNumber" class="form-label">Bank Routing Number</label>
                            <input type="text" id="editBankRoutingNumber" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="editBankAccountNumber" class="form-label">Bank Account Number</label>
                            <input type="text" id="editBankAccountNumber" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="editContactName" class="form-label">Contact Name</label>
                            <input type="text" id="editContactName" class="form-control" />
                        </div>
                        <div class="mb-3">
                            <label for="editVendorEmail" class="form-label">Email</label>
                            <input type="email" id="editVendorEmail" class="form-control" />
                        </div>
                        <!-- Phone field removed per new requirements -->
                        <div class="mb-3">
                            <label for="editVendorStatus" class="form-label">Status</label>
                            <select id="editVendorStatus" class="form-select">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editVendorNotes" class="form-label">Notes</label>
                            <textarea id="editVendorNotes" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger me-auto" id="deleteVendorBtn">Delete</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="updateVendorBtn">Update Vendor</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ===================================================================== -->
    <!--  NACHA SETTINGS CRUD MODALS                                           -->
    <!-- ===================================================================== -->

    <!-- Create NACHA Settings -->
    <div class="modal fade" id="createNachaSettingsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">New NACHA Configuration</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="createNachaSettingsForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="settingsEntityId" class="form-label">Entity*</label>
                            <select id="settingsEntityId" class="form-select" required></select>
                        </div>
                        <div class="mb-3">
                            <label for="settlementAccountId" class="form-label">Settlement Account*</label>
                            <select id="settlementAccountId" class="form-select" required></select>
                        </div>
                        <div class="mb-3">
                            <label for="companyName" class="form-label">Company Name* (≤16 chars)</label>
                            <input type="text" id="companyName" class="form-control" maxlength="16" required />
                        </div>
                        <div class="mb-3">
                            <label for="companyId" class="form-label">Company ID*</label>
                            <input type="text" id="companyId" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label for="originatingDfiId" class="form-label">Originating DFI ID*</label>
                            <input type="text" id="originatingDfiId" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label for="companyEntryDescription" class="form-label">Entry Description</label>
                            <input type="text" id="companyEntryDescription" class="form-control" />
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="isProduction" />
                            <label class="form-check-label" for="isProduction">Production Mode</label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="saveNachaSettingsBtn">Save Settings</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit NACHA Settings -->
    <div class="modal fade" id="editNachaSettingsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit NACHA Configuration</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="editNachaSettingsForm">
                    <div class="modal-body">
                        <input type="hidden" id="editNachaSettingsId" />
                        <div class="mb-3">
                            <label for="editSettingsEntityId" class="form-label">Entity*</label>
                            <select id="editSettingsEntityId" class="form-select" required></select>
                        </div>
                        <div class="mb-3">
                            <label for="editSettlementAccountId" class="form-label">Settlement Account*</label>
                            <select id="editSettlementAccountId" class="form-select" required></select>
                        </div>
                        <div class="mb-3">
                            <label for="editCompanyName" class="form-label">Company Name* (≤16 chars)</label>
                            <input type="text" id="editCompanyName" class="form-control" maxlength="16" required />
                        </div>
                        <div class="mb-3">
                            <label for="editCompanyId" class="form-label">Company ID*</label>
                            <input type="text" id="editCompanyId" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label for="editOriginatingDfiId" class="form-label">Originating DFI ID*</label>
                            <input type="text" id="editOriginatingDfiId" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label for="editCompanyEntryDescription" class="form-label">Entry Description</label>
                            <input type="text" id="editCompanyEntryDescription" class="form-control" />
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="editIsProduction" />
                            <label class="form-check-label" for="editIsProduction">Production Mode</label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger me-auto" id="deleteNachaSettingsBtn">Delete</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="updateNachaSettingsBtn">Update Settings</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ===================================================================== -->
    <!--  EDIT PAYMENT BATCH MODAL                                             -->
    <!-- ===================================================================== -->

    <div class="modal fade" id="editBatchModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Payment Batch</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="editBatchForm">
                    <div class="modal-body">
                        <input type="hidden" id="editBatchId" />
                        <div class="mb-3">
                            <label for="editBatchNumber" class="form-label">Batch Number*</label>
                            <input type="text" id="editBatchNumber" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label for="editBatchEntityId" class="form-label">Entity*</label>
                            <select id="editBatchEntityId" class="form-select" required></select>
                        </div>
                        <div class="mb-3">
                            <label for="editBatchFundId" class="form-label">Fund</label>
                            <select id="editBatchFundId" class="form-select"></select>
                        </div>
                        <div class="mb-3">
                            <label for="editNachaSettingsId" class="form-label">NACHA Settings*</label>
                            <select id="editNachaSettingsId" class="form-select" required></select>
                        </div>
                        <div class="mb-3">
                            <label for="editBatchDate" class="form-label">Batch Date*</label>
                            <input type="date" id="editBatchDate" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label for="editEffectiveDate" class="form-label">Effective Date*</label>
                            <input type="date" id="editEffectiveDate" class="form-control" required />
                        </div>
                        <div class="mb-3">
                            <label for="editBatchDescription" class="form-label">Description</label>
                            <input type="text" id="editBatchDescription" class="form-control" />
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger me-auto" id="deleteBatchBtn">Delete</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="updateBatchBtn">Update Batch</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
