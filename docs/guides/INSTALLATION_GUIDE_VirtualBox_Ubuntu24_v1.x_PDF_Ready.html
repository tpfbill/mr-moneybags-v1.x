<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr-Moneybags-v1.x Installation Guide – VirtualBox Ubuntu 24.04</title>
    <style>
        /* Print-friendly styles */
        @page {
            size: letter;
            margin: 1in 0.75in;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.5;
            color: #333;
            max-width: 8.5in;
            margin: 0 auto;
            padding: 0.5in 0;
        }
        h1, h2, h3, h4 {
            color: #2c3e50;
            page-break-after: avoid;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }
        h1 {
            font-size: 28pt;
            text-align: center;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h2 {
            font-size: 20pt;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            page-break-before: always;
        }
        h2:first-of-type {
            page-break-before: avoid;
        }
        h3 {
            font-size: 16pt;
        }
        h4 {
            font-size: 14pt;
        }
        p, li, td, th {
            font-size: 11pt;
            page-break-inside: avoid;
        }
        code, pre {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        code {
            padding: 2px 4px;
            font-size: 90%;
        }
        pre {
            padding: 12px;
            overflow-x: auto;
            font-size: 10pt;
            page-break-inside: avoid;
            white-space: pre-wrap;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            page-break-inside: avoid;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        hr {
            border: none;
            border-top: 1px solid #eee;
            margin: 30px 0;
        }
        blockquote {
            border-left: 4px solid #ddd;
            padding-left: 15px;
            color: #555;
            margin: 20px 0;
            font-style: italic;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        /* Print-specific adjustments */
        @media print {
            body {
                padding: 0;
            }
            pre, code {
                background-color: #f8f8f8 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            th {
                background-color: #f2f2f2 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            a {
                color: #000;
                text-decoration: underline;
            }
            a::after {
                content: " (" attr(href) ")";
                font-size: 90%;
                color: #555;
            }
        }
    </style>
</head>
<body>
    <h1>Mr-Moneybags-v1.x</h1>
    <h2>Installation Guide – Ubuntu 24.04 LTS Guest in VirtualBox (Windows / macOS Host)</h2>
    <p><em>Document version 1.x – August 2025</em></p>

    <hr>

    <h2>1 Overview</h2>
    <p>This guide walks through a <strong>clean installation</strong> of <strong>Mr-Moneybags-v1.x</strong> inside an Ubuntu 24.04 LTS virtual machine (VM) running under Oracle VM VirtualBox.<br>
    The procedure matches the <strong>working macOS reference environment</strong> (Node.js 18, PostgreSQL 16, Express 5) and leverages the project's cross-platform automation scripts.</p>

    <hr>

    <h2>2 Prerequisites &amp; Host Requirements</h2>
    <table>
        <thead>
            <tr>
                <th>Component</th>
                <th>Minimum</th>
                <th>Recommended</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Host OS</td>
                <td>Windows 10/11 or macOS 13+</td>
                <td>—</td>
            </tr>
            <tr>
                <td>CPU</td>
                <td>4 physical cores with VT-x / AMD-V</td>
                <td>6+ cores</td>
            </tr>
            <tr>
                <td>RAM</td>
                <td>8 GB</td>
                <td>16 GB (allocate ≥ 6 GB to guest)</td>
            </tr>
            <tr>
                <td>Disk</td>
                <td>40 GB free</td>
                <td>80 GB on SSD / NVMe</td>
            </tr>
            <tr>
                <td>Software</td>
                <td>Oracle VirtualBox ≥ 7.0, Ubuntu 24.04 Desktop ISO</td>
                <td>—</td>
            </tr>
        </tbody>
    </table>

    <blockquote>
        <p>Enable hardware virtualization in BIOS/UEFI before installing VirtualBox.</p>
    </blockquote>

    <hr>

    <h2>3 Create the VirtualBox VM</h2>
    <ol>
        <li>
            <p><strong>Download software</strong><br>
            • VirtualBox: <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a><br>
            • Ubuntu 24.04 ISO: <a href="https://ubuntu.com/download/desktop">https://ubuntu.com/download/desktop</a></p>
        </li>
        <li>
            <p><strong>New VM</strong><br>
            • Name <code>Ubuntu24-MrMoneybags-v1x</code><br>
            • Type <em>Linux</em> → Version <em>Ubuntu (64-bit)</em><br>
            • Memory <strong>6144 MB</strong> • Processors <strong>4 vCPU</strong><br>
            • Disk <strong>VDI</strong>, dynamically allocated, <strong>60 GB</strong></p>
        </li>
        <li>
            <p><strong>Tweaks</strong><br>
            Display → Graphics Controller <strong>VBoxSVGA</strong>, enable <strong>3-D Acceleration</strong><br>
            Network Adapter 1 → <strong>Bridged</strong> (preferred) or <strong>NAT</strong><br>
            Storage → attach the Ubuntu ISO.</p>
        </li>
        <li>
            <p><strong>Install Ubuntu</strong><br>
            Normal installation, enable third-party codecs (optional).<br>
            Create user <strong>fundadmin</strong> (will have <code>sudo</code>).<br>
            After first boot:</p>
            <pre><code>sudo apt update && sudo apt -y upgrade
sudo reboot</code></pre>
        </li>
    </ol>

    <hr>

    <h2>4 Install Runtime Dependencies inside the VM</h2>
    <pre><code># Essential tools
sudo apt install -y git build-essential curl

# Node.js 18 LTS (via NodeSource)
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs   # node 18.x, npm 10.x+

# PostgreSQL 16 (official PGDG repository)
echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" | \
  sudo tee /etc/apt/sources.list.d/pgdg.list
curl -fsSL https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
sudo apt update
sudo apt install -y postgresql-16

# Verify toolchain
node -v   # v18.x
npm  -v   # 10.x+
psql -V   # 16.x</code></pre>

    <hr>

    <h2>5 Application Installation</h2>
    <h3>5.1 Clone the Repository</h3>
    <pre><code>sudo mkdir -p /opt && cd /opt
sudo git clone https://github.com/your-org/mr-moneybags-v1.x.git
sudo chown -R $USER:$USER mr-moneybags-v1.x
cd mr-moneybags-v1.x</code></pre>

    <h3>5.2 Create <code>.env</code></h3>
    <pre><code>cat > .env <<'EOF'
# Database
PGHOST=localhost
PGPORT=5432
PGDATABASE=fund_accounting_db
PGUSER=npfadmin
PGPASSWORD=npfa123

# Server
PORT=3000
EOF
chmod 600 .env</code></pre>

    <h3>5.3 Install Node Dependencies</h3>
    <pre><code>npm ci</code></pre>

    <p>Dependencies (excerpt from <em>package.json</em>):</p>
    <ul>
        <li>express <strong>5.1.0</strong></li>
        <li>pg 8.16</li>
        <li>http-server 14.1</li>
        <li>concurrently 8.2</li>
    </ul>

    <hr>

    <h2>6 Database Setup</h2>
    <h3>Database Setup Commands</h3>
    <pre><code># Run the manual setup commands:
sudo -u postgres psql -f database/create-role-and-db.sql
sudo -u postgres psql -d fund_accounting_db -f database/schema-only.sql
sudo -u postgres psql -d fund_accounting_db -f database/sample-data-part1.sql
sudo -u postgres psql -d fund_accounting_db -f database/sample-data-part2.sql</code></pre>

    <blockquote>
        <p><strong>Note</strong> All schema and data-load files live in the repository's<br>
        top-level <code>database/</code> directory.</p>
    </blockquote>

    <p>These commands:</p>
    <ol>
        <li>Create role <strong>npfadmin / npfa123</strong> and database <strong>fund_accounting_db</strong>.</li>
        <li>Set up the complete schema (24 tables with all constraints and indexes).</li>
        <li>Load <em>comprehensive</em> sample data in two passes to avoid SQL-size limits:
            <ul>
                <li><strong><code>database/sample-data-part1.sql</code></strong> – core users, entities, funds, first half of accounts</li>
                <li><strong><code>database/sample-data-part2.sql</code></strong> – remaining accounts, journal entries, vendors & banking fixtures</li>
            </ul>
        </li>
        <li>Seed admin / user accounts with bcrypt-hashed passwords.</li>
    </ol>

    <hr>

    <h2>7 Run the Application</h2>
    <p>Open <strong>two terminals</strong> or use <code>npm run dev</code>.</p>

    <pre><code># Terminal 1 – REST API (port 3000)
node server-modular.js        # or simply `npm start`</code></pre>

    <pre><code># Terminal 2 – Static front-end (port 8080)
npx http-server . -p 8080 --no-cache</code></pre>

    <p>Helper scripts:</p>
    <pre><code>npm run client   # only front-end
npm run dev      # backend + frontend concurrently
npm start        # backend only (server-modular.js)</code></pre>

    <p>Browse to <strong>http://localhost:8080/index.html</strong>.</p>

    <hr>

    <h2>8 Testing &amp; Verification Checklist</h2>
    <table>
        <thead>
            <tr>
                <th>Test</th>
                <th>Steps</th>
                <th>Expected</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>API health</td>
                <td><code>curl http://localhost:3000/api/health</code></td>
                <td><code>{"status":"ok"}</code></td>
            </tr>
            <tr>
                <td>Dashboard</td>
                <td>Open <code>/index.html</code></td>
                <td>Summary cards and charts render</td>
            </tr>
            <tr>
                <td>Vendor Directory</td>
                <td><em>Vendor Payments ➜ Vendors</em></td>
                <td>List shows, <strong>Add Vendor</strong> modal works</td>
            </tr>
            <tr>
                <td>Payment Batch</td>
                <td><em>Vendor Payments ➜ Batches ➜ New</em></td>
                <td>Entity & Fund dropdowns populate</td>
            </tr>
            <tr>
                <td>NACHA File</td>
                <td>Create batch ➜ Approve ➜ <strong>Generate NACHA</strong></td>
                <td><code>.ACH</code> file appears & downloads</td>
            </tr>
            <tr>
                <td>DB inspection</td>
                <td><code>psql -d fund_accounting_db -c '\dt'</code></td>
                <td>24 tables including banking modules</td>
            </tr>
        </tbody>
    </table>

    <hr>

    <h2>9 Troubleshooting</h2>
    <table>
        <thead>
            <tr>
                <th>Symptom</th>
                <th>Resolution</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>"DB offline" badge</td>
                <td><code>sudo systemctl restart postgresql</code> and verify <code>.env</code></td>
            </tr>
            <tr>
                <td>Port 3000 in use</td>
                <td><code>sudo lsof -i:3000</code> → <code>kill &lt;PID&gt;</code></td>
            </tr>
            <tr>
                <td>Empty dropdowns (batch modal)</td>
                <td>Re-run schema and sample data scripts & restart API</td>
            </tr>
            <tr>
                <td>CSS not updating</td>
                <td>Hard-refresh (Ctrl-F5) or <code>--no-cache</code> flag</td>
            </tr>
        </tbody>
    </table>

    <hr>

    <h2>10 Performance Tips</h2>
    <ol>
        <li>Allocate extra vCPU/RAM to the VM.</li>
        <li>Enable <strong>Nested Paging</strong> & <strong>KVM Paravirtualization</strong> in VirtualBox.</li>
        <li>Store the VDI on an SSD/NVMe host drive.</li>
        <li>Tune PostgreSQL (<code>shared_buffers = 512MB</code>, <code>work_mem = 16MB</code>).</li>
        <li>Use <strong>Bridged</strong> networking for faster host↔guest transfers.</li>
    </ol>

    <hr>

    <h2>11 Security Considerations</h2>
    <ul>
        <li>Change default passwords (<code>npfa123</code>) before production.</li>
        <li>Keep <code>.env</code> file <strong>chmod 600</strong> and outside version control.</li>
        <li>Enable UFW:
            <pre><code>sudo ufw allow 8080/tcp
sudo ufw allow 3000/tcp
sudo ufw enable</code></pre>
        </li>
        <li>Regularly apply <code>apt upgrade</code> and PostgreSQL minor updates.</li>
        <li>Snapshot the VM after successful installation.</li>
    </ul>

    <hr>

    <h2>12 Appendix A – Useful Commands</h2>
    <pre><code># Stop both services
pkill -f http-server
pkill -f node

# Backup the database
sudo -u postgres pg_dump -Fc fund_accounting_db > fundacct_$(date +%F).dump

# Restore
sudo -u postgres pg_restore -d fund_accounting_db -c fundacct_2025-07-22.dump

# Refresh schema and sample data
psql -U npfadmin -d fund_accounting_db -f database/schema-only.sql
psql -U npfadmin -d fund_accounting_db -f database/sample-data-part1.sql
psql -U npfadmin -d fund_accounting_db -f database/sample-data-part2.sql</code></pre>

    <hr>

    <p><strong>Enjoy your fully-functional Mr. MoneyBags v1.x on Ubuntu 24.04!</strong></p>
    <p>For details on API endpoints and data model, see the in-app <strong>Documentation</strong> tab or <code>README.md</code>.</p>

    <div style="text-align: center; margin-top: 50px; font-size: 10pt; color: #777;">
        <p>Mr. MoneyBags v1.x Documentation<br>
        © 2025 The Principle Foundation<br>
        Last updated: August 12, 2025</p>
    </div>
</body>
</html>